<div class="card shadow-sm">
  <div class="card-body">
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="empresa-form">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-4">
          <i class="fas fa-building me-2"></i>
          {{ form.get("id")?.value ? "Editar Empresa" : "Cadastrar Empresa" }}
        </h2>
        <button
          type="button"
          class="btn btn-sm btn-outline-secondary"
          routerLink="/empresas"
        >
          <i class="fas fa-arrow-left me-1"></i> Voltar
        </button>
      </div>
      <div class="mb-3">
        <label for="cnpj" class="form-label">CNPJ*</label>
        <input
          type="text"
          id="cnpj"
          formControlName="cnpj"
          class="form-control"
          placeholder="00.000.000/0000-00"
          [appCnpjMask]="true"
        />
        <div
          *ngIf="form.get('cnpj')?.invalid && form.get('cnpj')?.touched"
          class="text-danger"
        >
          <span *ngIf="form.get('cnpj')?.errors?.['required']"
            >CNPJ é obrigatório</span
          >
          <span *ngIf="form.get('cnpj')?.errors?.['invalidCnpj']"
            >CNPJ inválido</span
          >
        </div>
      </div>

      <div class="mb-3">
        <label for="nomeFantasia" class="form-label">Nome Fantasia*</label>
        <input
          type="text"
          id="nomeFantasia"
          formControlName="nomeFantasia"
          class="form-control"
          placeholder="Nome da empresa"
        />
        <div
          *ngIf="
            form.get('nomeFantasia')?.invalid &&
            form.get('nomeFantasia')?.touched
          "
          class="text-danger"
        >
          <span *ngIf="form.get('nomeFantasia')?.errors?.['required']"
            >Nome fantasia é obrigatório</span
          >
          <span *ngIf="form.get('nomeFantasia')?.errors?.['minlength']"
            >Nome deve ter pelo menos 3 caracteres</span
          >
        </div>
      </div>

      <div class="mb-3">
        <label for="cep" class="form-label">CEP*</label>
        <div class="input-group">
          <input
            type="text"
            id="cep"
            formControlName="cep"
            class="form-control"
            placeholder="00000-000"
            appCepMask
          />
          <span *ngIf="validatingCep" class="input-group-text">
            <i class="fas fa-spinner fa-spin"></i>
          </span>
        </div>
        <div
          *ngIf="form.get('cep')?.invalid && form.get('cep')?.touched"
          class="text-danger"
        >
          <span *ngIf="form.get('cep')?.errors?.['required']"
            >CEP é obrigatório</span
          >
          <span *ngIf="form.get('cep')?.errors?.['invalidCep']"
            >CEP inválido</span
          >
          <span *ngIf="form.get('cep')?.errors?.['pattern']"
            >CEP deve conter 8 dígitos</span
          >
        </div>
      </div>

      <div class="d-flex justify-content-end mt-4">
        <button
          type="button"
          class="btn btn-outline-secondary me-2"
          (click)="form.reset()"
        >
          <i class="fas fa-undo me-1"></i> Limpar
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="loading || form.invalid"
        >
          <span
            *ngIf="loading"
            class="spinner-border spinner-border-sm me-1"
          ></span>
          <i class="fas fa-save me-1" *ngIf="!loading"></i>
          {{ form.get("id")?.value ? "Atualizar" : "Cadastrar" }}
        </button>
      </div>
    </form>
  </div>
</div>
